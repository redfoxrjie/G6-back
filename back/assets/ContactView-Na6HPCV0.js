import{_ as h,c as r,a as t,b as d,v as p,n as o,t as n,F as f,r as g,o as c,f as m,p as _,d as C}from"./index-ChEu6d7K.js";const b={data(){return{contactus:[],searchQuery:"",filter:"all",totalCount:0,completedCount:0,pendingCount:0,page:1,perPage:10}},computed:{filteredMails(){let e=this.contactus;return this.filter==="completed"?e=this.contactus.filter(s=>s.completed):this.filter==="pending"&&(e=this.contactus.filter(s=>!s.completed)),this.searchQuery&&(e=e.filter(s=>s.cu_id.includes(this.searchQuery))),e.slice((this.page-1)*this.perPage,this.page*this.perPage)},totalPages(){let e=this.contactus;return this.filter==="completed"?e=this.contactus.filter(s=>s.completed):this.filter==="pending"&&(e=this.contactus.filter(s=>!s.completed)),this.searchQuery&&(e=e.filter(s=>s.o_id.includes(this.searchQuery))),Math.ceil(e.length/this.perPage)}},methods:{fetchMails(){fetch("https://tibamef2e.com/cid101/g6/api/getContact.php").then(e=>{if(!e.ok)throw console.log("出錯"),new Error("Network response was not ok");return e.json()}).then(e=>{this.contactus=e.contactus.map(s=>({...s,completed:s.cu_status==="1"})),console.log(this.contactus[0]),this.calculateMailCounts()}).catch(e=>{console.error("There was a problem with the fetch operation:",e)})},calculateMailCounts(){this.totalCount=this.contactus.length,this.completedCount=this.contactus.filter(e=>e.completed).length,this.pendingCount=this.contactus.filter(e=>!e.completed).length},filterMails(e){this.filter=e,this.page=1},searchMails(){this.page=1},prevPage(){this.page>1&&this.page--},nextPage(){this.page<this.totalPages&&this.page++}},mounted(){this.fetchMails()}},u=e=>(_("data-v-a2b33e10"),e=e(),C(),e),v={class:"customer_mails"},M={class:"customer_mails_container"},P=u(()=>t("h3",null,"客戶信件管理",-1)),k={class:"search-container"},y={class:"btns-container"},w={class:"btns"},x={class:"mails-table"},Q=u(()=>t("thead",null,[t("tr",null,[t("th",null,"信件編號"),t("th",null,"姓名"),t("th",null,"電子信箱"),t("th",null,"內容"),t("th",null,"傳送時間"),t("th",null,"處理狀態")])],-1)),I=u(()=>t("i",{class:"circle"},null,-1)),S={class:"pagination"},V=["disabled"],B=["disabled"];function N(e,s,T,D,a,i){return c(),r("div",v,[t("div",M,[P,t("div",k,[d(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>a.searchQuery=l),placeholder:"信件編號"},null,512),[[p,a.searchQuery]]),t("button",{onClick:s[1]||(s[1]=(...l)=>i.searchMails&&i.searchMails(...l))},"搜尋")]),t("div",y,[t("ul",w,[t("li",{class:o(["btn",{active:a.filter==="all"}]),onClick:s[2]||(s[2]=l=>i.filterMails("all"))}," 全部("+n(a.totalCount)+") ",3),t("li",{class:o(["btn",{active:a.filter==="completed"}]),onClick:s[3]||(s[3]=l=>i.filterMails("completed"))}," 已完成("+n(a.completedCount)+") ",3),t("li",{class:o(["btn",{active:a.filter==="pending"}]),onClick:s[4]||(s[4]=l=>i.filterMails("pending"))}," 未處理("+n(a.pendingCount)+") ",3)])]),t("table",x,[Q,t("tbody",null,[(c(!0),r(f,null,g(i.filteredMails,l=>(c(),r("tr",{key:l.id},[t("td",null,n(l.cu_id),1),t("td",null,n(l.cu_name),1),t("td",null,n(l.cu_email),1),t("td",null,n(l.cu_message),1),t("td",null,n(l.cu_time),1),t("td",null,[t("span",{class:o(["status",l.statusClass])},[I,m(" "+n(l.cu_status),1)],2)])]))),128))])]),t("div",S,[t("button",{onClick:s[5]||(s[5]=(...l)=>i.prevPage&&i.prevPage(...l)),disabled:a.page===1},"‹",8,V),t("span",null,n(a.page)+" / "+n(i.totalPages),1),t("button",{onClick:s[6]||(s[6]=(...l)=>i.nextPage&&i.nextPage(...l)),disabled:a.page===i.totalPages},"›",8,B)])])])}const F=h(b,[["render",N],["__scopeId","data-v-a2b33e10"]]);export{F as default};
