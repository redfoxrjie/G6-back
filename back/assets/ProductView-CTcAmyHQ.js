import{_ as c,c as o,a as e,b as u,v as p,n as d,t as n,F as f,r as g,o as a,p as _,d as m}from"./index-CcafUdp0.js";const b={data(){return{orders:[],searchQuery:"",filter:"all",totalCount:0,completedCount:0,pendingCount:0,page:1,perPage:10}},computed:{filteredOrders(){let s=this.orders;return this.filter==="completed"?s=this.orders.filter(t=>t.completed):this.filter==="pending"&&(s=this.orders.filter(t=>!t.completed)),this.searchQuery&&(s=s.filter(t=>t.o_id.includes(this.searchQuery))),s.slice((this.page-1)*this.perPage,this.page*this.perPage)},totalPages(){let s=this.orders;return this.filter==="completed"?s=this.orders.filter(t=>t.completed):this.filter==="pending"&&(s=this.orders.filter(t=>!t.completed)),this.searchQuery&&(s=s.filter(t=>t.o_id.includes(this.searchQuery))),Math.ceil(this.filteredOrders.length/this.perPage)}},methods:{fetchOrders(){fetch("https://tibamef2e.com/cid101/g6/api/getOrderticket.php").then(s=>{if(!s.ok)throw console.log("出錯"),new Error("Network response was not ok");return s.json()}).then(s=>{this.orders=s.orders.map(t=>({...t,completed:t.o_status==="0"})),console.log(this.orders[0]),this.calculateOrderCounts()}).catch(s=>{console.error("There was a problem with the fetch operation:",s)})},calculateOrderCounts(){this.totalCount=this.orders.length,this.completedCount=this.orders.filter(s=>s.completed).length,this.pendingCount=this.orders.filter(s=>!s.completed).length},filterOrders(s){this.filter=s,this.page=1},searchOrders(){this.page=1},prevPage(){this.page>1&&this.page--},nextPage(){this.page<this.totalPages&&this.page++}},mounted(){this.fetchOrders()}},h=s=>(_("data-v-e3e9f21d"),s=s(),m(),s),v={class:"ticket_order_management"},C={class:"ticket_order_management_container"},k=h(()=>e("h3",null,"票券訂單管理",-1)),O={class:"search-container"},P={class:"btns-container"},y={class:"btns"},w={class:"orders-table"},x=h(()=>e("thead",null,[e("tr",null,[e("th",null,"訂單編號"),e("th",null,"訂單日期"),e("th",null,"會員姓名"),e("th",null,"金額"),e("th",null,"訂單狀態"),e("th",null,"支付方式"),e("th",null,"操作")])],-1)),Q=h(()=>e("td",null,[e("button",{class:"edit-btn"},"🖉")],-1)),I={class:"pagination"},S=["disabled"],B=["disabled"];function V(s,t,D,E,i,r){return a(),o("div",v,[e("div",C,[k,e("div",O,[u(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>i.searchQuery=l),placeholder:"訂單編號"},null,512),[[p,i.searchQuery]]),e("button",{onClick:t[1]||(t[1]=(...l)=>r.searchOrders&&r.searchOrders(...l))},"搜尋")]),e("div",P,[e("ul",y,[e("li",{class:d(["btn",{active:i.filter==="all"}]),onClick:t[2]||(t[2]=l=>r.filterOrders("all"))}," 全部("+n(i.totalCount)+") ",3),e("li",{class:d(["btn",{active:i.filter==="completed"}]),onClick:t[3]||(t[3]=l=>r.filterOrders("completed"))}," 已完成("+n(i.completedCount)+") ",3),e("li",{class:d(["btn",{active:i.filter==="pending"}]),onClick:t[4]||(t[4]=l=>r.filterOrders("pending"))}," 未處理("+n(i.pendingCount)+") ",3)])]),e("table",w,[x,e("tbody",null,[(a(!0),o(f,null,g(r.filteredOrders,l=>(a(),o("tr",{key:l.id},[e("td",null,n(l.o_id),1),e("td",null,n(l.o_date),1),e("td",null,n(l.o_name),1),e("td",null,n(l.o_price),1),e("td",null,n(l.o_status),1),e("td",null,n(l.o_payment),1),Q]))),128))])]),e("div",I,[e("button",{onClick:t[5]||(t[5]=(...l)=>r.prevPage&&r.prevPage(...l)),disabled:i.page===1},"‹",8,S),e("span",null,n(i.page)+" / "+n(r.totalPages),1),e("button",{onClick:t[6]||(t[6]=(...l)=>r.nextPage&&r.nextPage(...l)),disabled:i.page===r.totalPages},"›",8,B)])])])}const M=c(b,[["render",V],["__scopeId","data-v-e3e9f21d"]]);export{M as default};
