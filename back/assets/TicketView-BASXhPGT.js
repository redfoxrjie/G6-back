import{T as d}from"./ToggleSwitch-wBvFm4e3.js";import{_ as f,i as g,c,a as e,n as r,t as n,F as v,r as k,o,j as _,p as m,d as b}from"./index-ChEu6d7K.js";const C={components:{ToggleSwitch:d},data(){return{tickets:[],filter:"all",totalCount:0,activeCount:0,inactiveCount:0,popularCount:0,page:1,perPage:10}},computed:{filteredTickets(){let t=this.tickets;return this.filter==="active"?t=this.tickets.filter(i=>i.active):this.filter==="inactive"?t=this.tickets.filter(i=>!i.active):this.filter==="popular"&&(t=this.tickets.filter(i=>i.popular)),t.slice((this.page-1)*this.perPage,this.page*this.perPage)},totalPages(){let t=this.tickets;return this.filter==="active"?t=this.tickets.filter(i=>i.active):this.filter==="inactive"?t=this.tickets.filter(i=>!i.active):this.filter==="popular"&&(t=this.tickets.filter(i=>i.popular)),Math.ceil(t.length/this.perPage)}},methods:{fetchTickets(){fetch("https://tibamef2e.com/cid101/g6/api/getTickets.php").then(t=>{if(!t.ok)throw console.log("出錯"),new Error("Network response was not ok");return t.json()}).then(t=>{this.tickets=t.tickets.map(i=>({...i,active:i.t_active==="1",popular:i.t_popular==="1"})),this.calculateTicketCounts()}).catch(t=>{console.error("There was a problem with the fetch operation:",t)})},calculateTicketCounts(){this.totalCount=this.tickets.length,this.activeCount=this.tickets.filter(t=>t.active).length,this.inactiveCount=this.tickets.filter(t=>!t.active).length,this.popularCount=this.tickets.filter(t=>t.popular).length},filterTickets(t){this.filter=t,this.page=1},active_btn(t){return!t},addNewTicket(){},prevPage(){this.page>1&&this.page--},nextPage(){this.page<this.totalPages&&this.page++},parseServerImg(t){return`https://tibamef2e.com/cid101/g6/back/images/${t}`}},mounted(){this.fetchTickets()}},u=t=>(m("data-v-1290ef2d"),t=t(),b(),t),T={class:"ticket_management"},w={class:"ticket_management_container"},P=u(()=>e("h3",null,"票券管理",-1)),S={class:"btns-container"},V={class:"btns"},x={class:"tickets-table"},I=u(()=>e("thead",null,[e("tr",null,[e("th",null,"票券編號"),e("th",null,"票券縮圖"),e("th",null,"票券名稱"),e("th",null,"價格"),e("th",null,"上架狀態"),e("th",null,"熱門票券"),e("th",null,"編輯")])],-1)),N=["src"],y=u(()=>e("td",null,[e("button",{class:"edit-btn"},"🖉")],-1)),B={class:"pagination"},j=["disabled"],E=["disabled"];function F(t,i,U,z,a,s){const h=g("toggle-switch");return o(),c("div",T,[e("div",w,[P,e("div",S,[e("ul",V,[e("li",{class:r(["btn",{active:a.filter==="all"}]),onClick:i[0]||(i[0]=l=>s.filterTickets("all"))}," 全部("+n(a.totalCount)+") ",3),e("li",{class:r(["btn",{active:a.filter==="active"}]),onClick:i[1]||(i[1]=l=>s.filterTickets("active"))}," 已上架("+n(a.activeCount)+") ",3),e("li",{class:r(["btn",{active:a.filter==="inactive"}]),onClick:i[2]||(i[2]=l=>s.filterTickets("inactive"))}," 未上架("+n(a.inactiveCount)+") ",3),e("li",{class:r(["btn",{active:a.filter==="popular"}]),onClick:i[3]||(i[3]=l=>s.filterTickets("popular"))}," 熱門票券("+n(a.popularCount)+") ",3)]),e("button",{class:"btn add-button",onClick:i[4]||(i[4]=(...l)=>s.addNewTicket&&s.addNewTicket(...l))},"新增票券")]),e("table",x,[I,e("tbody",null,[(o(!0),c(v,null,k(s.filteredTickets,l=>(o(),c("tr",{key:l.id},[e("td",null,n(l.t_id),1),e("td",null,[e("img",{src:s.parseServerImg(l.t_image),alt:"票券縮圖",class:"preview-img"},null,8,N)]),e("td",null,n(l.t_name),1),e("td",null,n(l.t_price),1),e("td",null,[_(h,{modelValue:l.active,"onUpdate:modelValue":p=>l.active=p},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,n(l.t_viewers?"否":"是"),1),y]))),128))])]),e("div",B,[e("button",{onClick:i[5]||(i[5]=(...l)=>s.prevPage&&s.prevPage(...l)),disabled:a.page===1},"‹",8,j),e("span",null,n(a.page)+" / "+n(s.totalPages),1),e("button",{onClick:i[6]||(i[6]=(...l)=>s.nextPage&&s.nextPage(...l)),disabled:a.page===s.totalPages},"›",8,E)])])])}const M=f(C,[["render",F],["__scopeId","data-v-1290ef2d"]]);export{M as default};
